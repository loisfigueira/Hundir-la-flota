[2026-02-18 16:17:14] [INFO] [AppLogger] Logger inicializado (reseteado) en archivo: C:\Users\figue\Documents\Proyectos\PSP\Hundir la flota\server\server.log
[2026-02-18 16:17:14] [INFO] [GameServer] SERVIDOR HUNDIR LA FLOTA - INICIADO
[2026-02-18 16:17:14] [INFO] [GameServer] Host: localhost | Puerto: 5678 | Max Clientes: 10
[2026-02-18 16:17:14] [DEBUG] [GameServer] Servidor escuchando activamente en localhost:5678
[2026-02-18 16:17:14] [INFO] [Main] Servidor en ejecución. Presiona Ctrl+C para detener.
[2026-02-18 16:17:14] [DEBUG] [GameServer] Esperando nueva conexión...
[2026-02-18 16:17:28] [INFO] [GameServer] Nueva conexión aceptada desde 127.0.0.1
[2026-02-18 16:17:28] [DEBUG] [GameServer] Esperando nueva conexión...
[2026-02-18 16:17:28] [DEBUG] [GameServer] [Client-663a3a08] Iniciando handleClient para socket: 127.0.0.1
[2026-02-18 16:17:28] [INFO] [GameServer] [Client-663a3a08] Cliente añadido a la lista activa. Total: 1
[2026-02-18 16:17:28] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] Iniciando startLogic para player: Unknown
[2026-02-18 16:17:28] [INFO] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] Cliente conectado desde 127.0.0.1:60557
[2026-02-18 16:17:28] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] <<< RECIBIDO: {"type":"connection_handshake","playerName":"peruco"}
[2026-02-18 16:17:28] [INFO] [ClientHandler] [ClientHandler] HANDSHAKE recibido de peruco
[2026-02-18 16:17:28] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] >>> ENVIANDO: {"type":"connection_welcome","playerId":"ddb8ae72-d84d-4647-9374-5ad0458d4428","serverVersion":"1.0.0","message":"Bienvenido a Hundir la Flota, peruco!"}
[2026-02-18 16:17:28] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] >>> ENVIANDO: {"type":"stats_response","playerStats":{"playerName":"peruco","gamesPlayed":3,"gamesWon":3,"gamesLost":0,"pvpWon":1,"pveWon":2,"totalShots":172,"totalHits":90,"winStreak":3,"bestWinStreak":3,"averageAccuracy":52.32558139534884,"bestAccuracy":100.0,"fastestWinTurns":0,"totalPlayTimeSeconds":0},"leaderboard":[{"rank":1,"playerName":"peruco","gamesWon":3,"winRate":100.0,"bestStreak":3},{"rank":2,"playerName":"paco","gamesWon":0,"winRate":0.0,"bestStreak":0}]}
[2026-02-18 16:17:28] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] <<< RECIBIDO: {"type":"system_ping","timestamp":1771427848434}
[2026-02-18 16:17:28] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] >>> ENVIANDO: {"type":"system_pong"}
[2026-02-18 16:17:36] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] <<< RECIBIDO: {"type":"action_start_pve","config":{"boardSize":8},"difficulty":"EASY"}
[2026-02-18 16:17:36] [INFO] [LobbyManager] Lobby PvE creado 76374322-1e98-426d-8610-249a3042d760 para peruco
[2026-02-18 16:17:36] [INFO] [GameSession] [GameSession-game_pve_1771427856064] Bot Hunter inicializado con 10 barcos en tablero 8x8
[2026-02-18 16:17:36] [INFO] [GameLogic] Partida iniciada: game_pve_1771427856064 (PvE=true) Config=8x8
[2026-02-18 16:17:36] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] >>> ENVIANDO: {"type":"matchmaking_found","gameId":"game_pve_1771427856064","opponentName":"Bot Hunter (EASY)","isPvE":true,"config":{"boardSize":8}}
[2026-02-18 16:17:36] [INFO] [GameSession] [GameSession-game_pve_1771427856064] Iniciando partida. Enviando fase PLACEMENT.
[2026-02-18 16:17:36] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] >>> ENVIANDO: {"type":"response_game_state","phase":"PLACEMENT","currentTurn":"ddb8ae72-d84d-4647-9374-5ad0458d4428","turnTimeSeconds":60,"myBoard":{"cells":[["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"]],"ships":[]},"opponentBoard":{"cells":[["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"]]},"status":"Coloca tus barcos"}
[2026-02-18 16:17:47] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] <<< RECIBIDO: {"type":"action_confirm_deployment","ships":[{"type":"CARRIER","coordinate":{"x":1,"y":0},"orientation":"HORIZONTAL"},{"type":"BATTLESHIP","coordinate":{"x":2,"y":1},"orientation":"HORIZONTAL"},{"type":"BATTLESHIP","coordinate":{"x":2,"y":2},"orientation":"HORIZONTAL"},{"type":"CRUISER","coordinate":{"x":2,"y":5},"orientation":"HORIZONTAL"},{"type":"CRUISER","coordinate":{"x":5,"y":4},"orientation":"HORIZONTAL"},{"type":"CRUISER","coordinate":{"x":2,"y":3},"orientation":"HORIZONTAL"},{"type":"DESTROYER","coordinate":{"x":5,"y":3},"orientation":"HORIZONTAL"},{"type":"DESTROYER","coordinate":{"x":6,"y":2},"orientation":"HORIZONTAL"},{"type":"DESTROYER","coordinate":{"x":6,"y":1},"orientation":"HORIZONTAL"},{"type":"DESTROYER","coordinate":{"x":6,"y":0},"orientation":"HORIZONTAL"}]}
[2026-02-18 16:17:47] [DEBUG] [GameSession] [GameSession-game_pve_1771427856064] peruco intenta colocar barcos.
[2026-02-18 16:17:47] [INFO] [GameSession] [GameSession-game_pve_1771427856064] peruco (P1) listo.
[2026-02-18 16:17:47] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] >>> ENVIANDO: {"type":"response_placement_confirmed","shipType":"BATTLESHIP"}
[2026-02-18 16:17:47] [DEBUG] [GameSession] [GameSession-game_pve_1771427856064] Cambiando fase a BATTLE tras despliegue de peruco
[2026-02-18 16:17:47] [INFO] [GameSession] [GameSession-game_pve_1771427856064] Ambos jugadores listos. Iniciando fase BATTLE.
[2026-02-18 16:17:47] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] >>> ENVIANDO: {"type":"response_game_start","gameId":"game_pve_1771427856064","opponentName":"Bot Hunter (EASY)","turnTimeSeconds":60}
[2026-02-18 16:17:47] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] >>> ENVIANDO: {"type":"response_game_state","phase":"BATTLE","currentTurn":"ddb8ae72-d84d-4647-9374-5ad0458d4428","turnTimeSeconds":60,"myBoard":{"cells":[["EMPTY","SHIP","SHIP","SHIP","SHIP","SHIP","SHIP","SHIP"],["EMPTY","EMPTY","SHIP","SHIP","SHIP","SHIP","SHIP","SHIP"],["EMPTY","EMPTY","SHIP","SHIP","SHIP","SHIP","SHIP","SHIP"],["EMPTY","EMPTY","SHIP","SHIP","SHIP","SHIP","SHIP","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","SHIP","SHIP","SHIP"],["EMPTY","EMPTY","SHIP","SHIP","SHIP","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"]],"ships":[{"type":"CARRIER","coordinates":[{"x":1,"y":0},{"x":2,"y":0},{"x":3,"y":0},{"x":4,"y":0},{"x":5,"y":0}],"sunk":false},{"type":"BATTLESHIP","coordinates":[{"x":2,"y":1},{"x":3,"y":1},{"x":4,"y":1},{"x":5,"y":1}],"sunk":false},{"type":"BATTLESHIP","coordinates":[{"x":2,"y":2},{"x":3,"y":2},{"x":4,"y":2},{"x":5,"y":2}],"sunk":false},{"type":"CRUISER","coordinates":[{"x":2,"y":5},{"x":3,"y":5},{"x":4,"y":5}],"sunk":false},{"type":"CRUISER","coordinates":[{"x":5,"y":4},{"x":6,"y":4},{"x":7,"y":4}],"sunk":false},{"type":"CRUISER","coordinates":[{"x":2,"y":3},{"x":3,"y":3},{"x":4,"y":3}],"sunk":false},{"type":"DESTROYER","coordinates":[{"x":5,"y":3},{"x":6,"y":3}],"sunk":false},{"type":"DESTROYER","coordinates":[{"x":6,"y":2},{"x":7,"y":2}],"sunk":false},{"type":"DESTROYER","coordinates":[{"x":6,"y":1},{"x":7,"y":1}],"sunk":false},{"type":"DESTROYER","coordinates":[{"x":6,"y":0},{"x":7,"y":0}],"sunk":false}]},"opponentBoard":{"cells":[["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"],["EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY","EMPTY"]]},"status":"Tu turno"}
[2026-02-18 16:17:47] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] >>> ENVIANDO: {"type":"response_turn_update","playerId":"ddb8ae72-d84d-4647-9374-5ad0458d4428","secondsLeft":60}
[2026-02-18 16:17:48] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] >>> ENVIANDO: {"type":"response_turn_update","playerId":"ddb8ae72-d84d-4647-9374-5ad0458d4428","secondsLeft":59}
[2026-02-18 16:17:49] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] >>> ENVIANDO: {"type":"response_turn_update","playerId":"ddb8ae72-d84d-4647-9374-5ad0458d4428","secondsLeft":58}
[2026-02-18 16:17:50] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] >>> ENVIANDO: {"type":"response_turn_update","playerId":"ddb8ae72-d84d-4647-9374-5ad0458d4428","secondsLeft":57}
[2026-02-18 16:17:51] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] >>> ENVIANDO: {"type":"response_turn_update","playerId":"ddb8ae72-d84d-4647-9374-5ad0458d4428","secondsLeft":56}
[2026-02-18 16:17:52] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] >>> ENVIANDO: {"type":"response_turn_update","playerId":"ddb8ae72-d84d-4647-9374-5ad0458d4428","secondsLeft":55}
[2026-02-18 16:17:52] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] <<< RECIBIDO: {"type":"action_leave_game"}
[2026-02-18 16:17:52] [INFO] [GameSession] [GameSession-game_pve_1771427856064] Jugador peruco ha abandonado la partida. Procesando derrota por abandono.
[2026-02-18 16:17:52] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] >>> ENVIANDO: {"type":"response_game_over","winnerId":"BOT_HUNTER_ID","stats":{"totalShots":0,"successfulHits":0,"shipsDestroyed":0,"accuracy":0.0,"winStreak":0}}
[2026-02-18 16:17:52] [INFO] [GameSession] [GameSession-game_pve_1771427856064] Guardando records por abandono de peruco. Ganador: Bot Hunter (EASY)
[2026-02-18 16:17:52] [INFO] [GameSession] [GameSession-game_pve_1771427856064] Limpiando sesión ID: game_pve_1771427856064. Jugadores liberados.
[2026-02-18 16:17:54] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] <<< RECIBIDO: {"type":"stats_request"}
[2026-02-18 16:17:54] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] >>> ENVIANDO: {"type":"stats_response","playerStats":{"playerName":"peruco","gamesPlayed":4,"gamesWon":3,"gamesLost":1,"pvpWon":1,"pveWon":2,"pveLost":1,"totalShots":172,"totalHits":90,"winStreak":0,"bestWinStreak":3,"averageAccuracy":52.32558139534884,"bestAccuracy":100.0,"fastestWinTurns":0,"totalPlayTimeSeconds":0},"leaderboard":[{"rank":1,"playerName":"peruco","gamesWon":3,"winRate":75.0,"bestStreak":3},{"rank":2,"playerName":"paco","gamesWon":0,"winRate":0.0,"bestStreak":0}]}
[2026-02-18 16:17:58] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] <<< RECIBIDO: {"type":"system_ping","timestamp":1771427878440}
[2026-02-18 16:17:58] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] >>> ENVIANDO: {"type":"system_pong"}
[2026-02-18 16:18:05] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] <<< RECIBIDO: {"type":"connection_disconnect"}
[2026-02-18 16:18:05] [INFO] [ClientHandler] [ClientHandler] peruco solicitó desconexión.
[2026-02-18 16:18:05] [INFO] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] Iniciando desconexión de peruco...
[2026-02-18 16:18:05] [INFO] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] Socket cerrado con éxito.
[2026-02-18 16:18:05] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] Notificando desconexión a GameLogic...
[2026-02-18 16:18:05] [INFO] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] Cliente removido del servidor.
[2026-02-18 16:18:05] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] Saliendo del bucle de lectura. Cancelando keepAliveJob.
[2026-02-18 16:18:05] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] Ejecutando bloque finally de startLogic.
[2026-02-18 16:18:05] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] Intento de desconexión pero ya estaba desconectado.
[2026-02-18 16:18:05] [INFO] [GameServer] [Client-663a3a08] Finalizando handleClient. Removiendo de la lista.
[2026-02-18 16:18:05] [DEBUG] [ClientHandler] [ClientHandler-ddb8ae72-d84d-4647-9374-5ad0458d4428] Intento de desconexión pero ya estaba desconectado.
[2026-02-18 16:18:10] [INFO] [GameServer] Servidor detenido
[2026-02-18 16:18:10] [INFO] [Main] Señal de apagado recibida
[2026-02-18 16:18:10] [INFO] [GameServer] Servidor detenido
